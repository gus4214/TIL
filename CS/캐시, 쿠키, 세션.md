# 캐시, 쿠키, 세션

## > 정의

- **캐시(Cache)**
  이전에 사용했던 데이터들을 보관하는 사용자의 저장공간
  → 재사용할 수 있는 데이터(이미지, HTML파일)등을 캐시에 저장한다.
  **ex)**
  캐시를 이용하면 사용자가 웹이나 앱에 처음 접속한 이후 다시 접속할 때 좀 더 빠르게 로딩되도록 도와준다.
  유튜브는 한국에 캐시 서버를 운영하고 있어 영상을 요청했을 때 빠른 서비스를 제공하며
  전송 비용을 줄이고 있다.

- **쿠키(Cookie)**
  http 통신의 무상태Stateless와 비연결성(Connectionless) 특성 때문에 서버가 기억하지 못하는 사용자의 정보를 알 기 위해 사용자에게 저장하는 크기가 작은 문자열 파일
  **ex)**
  쇼핑몰에서 장바구니에 상품을 넣어 놓고 로그인을 하지 않아도 그대로 담겨있다.
  ”팦업 창 일주일 간 다시 보지 않기”, “언어 설정”
- **세션(Session)**
  사용자가 사이트에서 로그인했을 때 일정 기간 동안 서버에서 사용자에 대한 정보를 기록하고 보관하여
  사용자를 관리하는 서버의 저장공간
  **ex)**
  서버에서는 사용자가 로그인을 하면 로그인한 사용자의 정보를 세션에서 관리하고 사용자에게 세션 값을 제공

## > 캐시

캐시는 컴퓨터의 처리 속도를 더 빠르게 하기 위해 탄생 하였다.

웹, 앱에서 캐시는 사용자의 저장소에 데이터를 저장하게 해서 빠른 서비스를 제공,
서버에서는 데이터 전송 부하를 낮출 수 있다.

- 캐시서버

국내 배송과 해외 배송의 차이라고 생각하면 된다!

데이터 저장소를 여러 나라에 만들어서 비용과 시간을 절감한다.

<br />

## > 쿠키

**특징**

- 최대 4KB 까지 저장 가능
- 도메인당 최소 50개까지 지원, 브라우저당 최소 3000개 보관 가능
- 유효 날짜와 만료 시간
- 안전 설정: 암호화된 쿠키 사용 설정 (https에서 쿠키를 전송 가능하게 만듬)
- HttpOnly: 쿠키를 http에서만 사용하게 하여 XSS(Cross Site Scripting) 같은
  자바스크립트를 이용한 쿠키 탈취 방지
- Samesite: 다른 도메인에 쿠키 전송 허용을 설정할 수 있다.

**동작 순서**

1. 클라이언트가 사이트에 처음 방문하여 서버에 웹 페이지를 요청, 웹 서버는 쿠키를 생성
2. 생성한 쿠키에 정보를 담아 HTTP 화면을 돌려줄 때, 같이 클라이언트에게 돌려줌
3. 받은 쿠키는 클라이언트가 가지고 있고(로컬 PC에 저장) 다시 서버에 요청할 때 요청과 함께 쿠키를 전송
4. 동일 사이트 재방문시 클라이언트의 PC에 해당 쿠키가 있는 경우, 요청 페이지와 함께 쿠키를 전송

**종류**

1. 퍼스트 파티 쿠키 : 쿠키의 도메인과 접속한 도메인이 일치하는 쿠키
2. 세션 쿠키 : 세션에서 사용자의 세션 ID값을 가지고 있는 쿠키
3. 보안 쿠키 : https로 암호화하여 사용자와 서버가 주고받는 쿠키
4. 서드 파티 쿠키 : 사용자가 접속한 사이트 정보를 얻어서 사용자에게 맞춤 광고를 제공할 때 사용하는 쿠키

<br />

## > 세션

**특징**

- 서버가 사용자의 접속 상태를 관리하고 서버의 저장소 여유만큼 세션을 저장가능
- 웹 브라우저가 종료되면 세션 쿠키는 삭제
- 따로 용량의 제한이 없다. (서버 능력에 따라 다를 수 있음)
- 세션 id만 저장하고 id가를 빼앗겨도 사용자의 개인 정보를 알 수 없고 일정 기간 지나면 사라지기 때문에
  보안성이 좋다.

**단점**

- 사용자가 많아질수록 부하가 발생한다.
- 서버의 데이터베이스에서 매번 사용자 조회를 해야 한다.
- 여러 개의 서버를 사용하면 세션의 관리가 어렵다.

**동작 순서**

1. 클라이언트 페이지가 요청
2. 서버가 클라이언트마다 개별의 세션 ID 부여
3. 클라이언트는 요청할 때마다 세션 ID를 서버에 전달
4. 서버는 받은 세션 ID로 클라이언트 정보를 가져와 활용

<br />

## > 쿠키, 세션의 차이

서버가 사용자의 정보를 기억하지 못한다면 큰 불편함이 있을 수 있기 때문에 쿠키 사용은 필수이다.

쿠키는 보안에 취약하지만 누군가가 봐도 상관없는 데이터를 넣어서 사용하면 서버가 사용자 정보를 받아 그에 맞는 서비스를 제공할 수 있다.

- 저장위치
  쿠키: 클라이언트에 파일로 저장되어 있음
  세션: 서버에 저장
- 보안
  해커가 쿠키에 담긴 개인 정보를 빼앗을 경우 중요한 정보가 유출될 수 있는데,
  세션을 이용하면 사용자와 서버가 세션 ID를 주고 받기 때문에 세션 ID만을 빼앗기게 된다.
  → 쿠키보다 보안성이 우수하다.
- 속도
  쿠키는 쿠키에 정보가 있으므로 서버에 요청시 빠르다.
  세션은 정보가 서버에 있으므로 처리가 요구되어 비교적 느림
